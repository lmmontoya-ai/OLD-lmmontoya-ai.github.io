---
// src/components/ui/Button.astro
// Reusable button component with primary/secondary variants and consistent styling
// Now using class-variance-authority for variant management

import { buttonVariants, cn, type ButtonVariants } from "../../utils/variants";

interface Props extends ButtonVariants {
  href?: string;
  class?: string;
  ariaLabel?: string;
  type?: "button" | "submit" | "reset";
}

const {
  href,
  variant = "primary",
  size = "md",
  fullWidth = false,
  rounded = false,
  class: className = "",
  ariaLabel,
  type = "button",
} = Astro.props;

// Generate classes using CVA
const classes = cn(
  buttonVariants({ variant, size, fullWidth, rounded }),
  className
);

// Determine which element to render
const Element = href ? "a" : "button";

// Check if this is a primary variant for special styling
const isPrimary = variant === "primary";
---

<Element
  href={href}
  class={classes}
  aria-label={ariaLabel}
  type={!href ? type : undefined}
  {...href ? { target: href.startsWith("http") ? "_blank" : undefined } : {}}
  {...href
    ? { rel: href.startsWith("http") ? "noopener noreferrer" : undefined }
    : {}}
>
  {isPrimary && (
    <!-- Theme-aware background for primary buttons using modern CSS variables -->
    <div class="absolute inset-0 bg-interactive-secondary"></div>
  )}
  {isPrimary && (
    <!-- Hover glow effect for primary buttons using modern utilities -->
    <div
      class="absolute inset-0 transition-spring opacity-0 hover:opacity-100 hover-glow"
      style="box-shadow: var(--shadow-glow-highlight), var(--shadow-lg);"
    ></div>
  )}

  <!-- Button content - Added flex and items-center to keep text and icons on same line -->
  <span class="relative z-10 flex items-center">
    <slot />
  </span>
</Element>